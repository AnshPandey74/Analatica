<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Analatica ‚Äì Dashboard</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <style>
        body {
            padding: 30px;
            background-color: #f7f7f7;
            font-family: "Inter", sans-serif;
        }

        footer {
            background: #111;
            color: white;
            padding: 35px 10px;
            text-align: center;
            margin-top: 60px;
        }

        footer a {
            color: #4bb8ff;
            text-decoration: none;
        }

        /* Dark Mode */
        body.dark {
            background: #111;
            color: #ddd;
        }

        body.dark footer {
            background: #000;
        }

        .dark-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 6px 14px;
            border-radius: 6px;
            z-index: 10;
        }
    </style>
</head>

<body>

    <!-- Dark Button -->
    <button id="darkModeToggle" class="dark-toggle btn btn-dark">Dark</button>

    <!-- HEADER -->
    <header class="text-center mb-5">
        <h1>Analytics Dashboard</h1>
        <p class="text-muted">View real-time collected events and usage metrics.</p>
    </header>

    <div class="container">

        <div class="row mb-4">
            <div class="col-md-8">
                <canvas id="eventCounts"></canvas>
            </div>
            <div class="col-md-4">
                <canvas id="deviceBreakdown"></canvas>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <canvas id="hourlyActivity"></canvas>
            </div>
        </div>

    </div>

    <!-- FOOTER -->
    <footer>
        <p style="margin-bottom:6px;">Made with ‚ù§Ô∏è by <strong>Ansh Pandey</strong></p>
        
        <p>
            üì© <a href="mailto:anshpandey882@gmail.com">anshpandey882@gmail.com</a><br>
            üîó <a href="https://www.linkedin.com/in/anshpandey74" target="_blank">LinkedIn</a> ‚Ä¢
            <a href="https://github.com/AnshPandey74" target="_blank">GitHub</a>
        </p>

        <p style="opacity:0.6;font-size:14px;">¬© 2025 Analatica. All rights reserved.</p>
    </footer>

    <script>
        const toggle = document.getElementById("darkModeToggle");
        toggle.addEventListener("click", () => {
            document.body.classList.toggle("dark");
            toggle.innerText = document.body.classList.contains("dark") ? "Light" : "Dark";
        });
    </script>

    <script>
        fetch('/api/analytics/event_counts')
            .then(r => r.json())
            .then(data => {
                new Chart(document.getElementById('eventCounts'), {
                    type: 'bar',
                    data: {
                        labels: data.map(x => x.event_name),
                        datasets: [{ label: 'Events', data: data.map(x => x.count) }]
                    }
                });
            });

        fetch('/api/analytics/device_breakdown')
            .then(r => r.json())
            .then(data => {
                new Chart(document.getElementById('deviceBreakdown'), {
                    type: 'pie',
                    data: {
                        labels: data.map(x => x.device_type),
                        datasets: [{ data: data.map(x => x.count) }]
                    }
                });
            });

        fetch('/api/analytics/hourly')
            .then(r => r.json())
            .then(data => {
                new Chart(document.getElementById('hourlyActivity'), {
                    type: 'line',
                    data: {
                        labels: data.map(x => x.hour),
                        datasets: [{ label: 'Events Per Hour', data: data.map(x => x.count) }]
                    }
                });
            });
    </script>

</body>
</html>
